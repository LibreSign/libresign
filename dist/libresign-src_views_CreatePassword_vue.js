(self.webpackChunklibresign=self.webpackChunklibresign||[]).push([["src_views_CreatePassword_vue"],{462:(e,t,s)=>{"use strict";s.d(t,{N:()=>O});var n=s(5072),i=s.n(n),r=s(7825),a=s.n(r),o=s(7659),l=s.n(o),d=s(5056),c=s.n(d),u=s(540),p=s.n(u),f=s(1113),h=s.n(f),g=s(9646),m={};m.styleTagTransform=h(),m.setAttributes=c(),m.insert=l().bind(null,"head"),m.domAPI=a(),m.insertStyleElement=p();i()(g.A,m);g.A&&g.A.locals&&g.A.locals;var w=s(3814),A=s(2981),b=s(5043),y=s(7334),v=s(1431),C=s(3168),_=s(3653),x=s(9841),P=s(6849);const E={name:"EyeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var S=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon eye-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},L=[];const N=(0,v.n)(E,S,L,!1,null,null).exports,k={name:"EyeOffIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var B=function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon eye-off-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])},T=[];const F=(0,v.n)(k,B,T,!1,null,null).exports;(0,_.r)(_.A);const H=(0,A.C)("core","capabilities",{}).password_policy||null,M=new Set(Object.keys(P.N.props)),$={name:"NcPasswordField",components:{NcInputField:P.N,Eye:N,EyeOff:F},inheritAttrs:!1,model:{prop:"modelValue",event:"update:modelValue"},props:{" ":{},...P.N.props,showTrailingButton:{type:Boolean,default:!0},trailingButtonLabel:void 0,checkPasswordStrength:{type:Boolean,default:!1},minlength:{type:Number,default:0},maxlength:{type:Number,default:null},asText:{type:Boolean,default:!1}},emits:["valid","invalid","update:value","update:modelValue","update:model-value"],setup:()=>({model:(0,x.u)("value","update:value")}),data:()=>({isPasswordHidden:!0,internalHelpMessage:"",isValid:null}),computed:{computedError(){return this.error||!1===this.isValid},computedSuccess(){return this.success||!0===this.isValid},computedHelperText(){return this.helperText.length>0?this.helperText:this.internalHelpMessage},rules(){const{minlength:e}=this;return{minlength:e??H?.minLength}},trailingButtonLabelPassword(){return this.isPasswordHidden?(0,_.a)("Show password"):(0,_.a)("Hide password")},propsAndAttrsToForward(){return{...this.$attrs,...Object.fromEntries(Object.entries(this.$props).filter((([e])=>M.has(e))))}}},watch:{model(e){if(this.checkPasswordStrength){if(null===H)return;this.checkPassword(e)}}},methods:{focus(){this.$refs.inputField.focus()},select(){this.$refs.inputField.select()},handleInput(e){this.model=e.target.value},togglePasswordVisibility(){this.isPasswordHidden=!this.isPasswordHidden},checkPassword:y((async function(e){try{const{data:t}=await b.Ay.post((0,w.KT)("apps/password_policy/api/v1/validate"),{password:e});if(this.isValid=t.ocs.data.passed,t.ocs.data.passed)return this.internalHelpMessage=(0,_.a)("Password is secure"),void this.$emit("valid");this.internalHelpMessage=t.ocs.data.reason,this.$emit("invalid")}catch(e){C.l.error("Password policy returned an error",e)}}),500)}};var D=function(){var e=this,t=e._self._c;return t("NcInputField",e._g(e._b({ref:"inputField",attrs:{type:e.isPasswordHidden&&!e.asText?"password":"text","trailing-button-label":e.trailingButtonLabelPassword,"helper-text":e.computedHelperText,error:e.computedError,success:e.computedSuccess,minlength:e.rules.minlength,"input-class":{"password-field__input--secure-text":e.isPasswordHidden&&e.asText}},on:{"trailing-button-click":e.togglePasswordVisibility,input:e.handleInput},scopedSlots:e._u([e.$scopedSlots.icon||e.$slots.default||e.$scopedSlots.default?{key:"icon",fn:function(){return[e._t("icon",(function(){return[e._t("default")]}))]},proxy:!0}:null,{key:"trailing-button-icon",fn:function(){return[e.isPasswordHidden?t("Eye",{attrs:{size:18}}):t("EyeOff",{attrs:{size:18}})]},proxy:!0}],null,!0)},"NcInputField",e.propsAndAttrsToForward,!1),e.$listeners))},I=[];const O=(0,v.n)($,D,I,!1,null,"09fb8faa").exports},6044:(e,t,s)=>{"use strict";s.d(t,{A:()=>n.N});var n=s(462)},6375:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>f});var i=n(5043),r=n(5168),a=n(3814),o=n(7012),l=n(8461),d=n(9892),c=n(6044),u=n(7117);const p={name:"CreatePassword",components:{NcDialog:l.A,NcPasswordField:c.A,NcButton:o.A,NcLoadingIcon:d.A},setup:()=>({signMethodsStore:(0,u.k)()}),data:()=>({hasLoading:!1,password:""}),methods:{async send(){this.hasLoading=!0,await i.Ay.post((0,a.KT)("/apps/libresign/api/v1/account/signature"),{signPassword:this.password}).then((()=>{(0,r.Te)(t("libresign","New password to sign documents has been created")),this.signMethodsStore.setHasSignatureFile(!0),this.password="",this.$emit("password:created",!0),this.signMethodsStore.closeModal("createPassword")})).catch((e=>{let{response:s}=e;this.signMethodsStore.setHasSignatureFile(!1),s.data?.ocs?.data?.message?(0,r.Qg)(s.data.ocs.data.message):(0,r.Qg)(t("libresign","Error creating new password, please contact the administrator")),this.$emit("password:created",!1)})),this.hasLoading=!1}}};const f=(0,n(4486).A)(p,(function(){var e=this,t=e._self._c;return e.signMethodsStore.modal.createPassword?t("NcDialog",{attrs:{name:e.t("libresign","Password Creation"),"is-form":""},on:{submit:function(t){return t.preventDefault(),e.send()},closing:function(t){return e.signMethodsStore.closeModal("createPassword")}},scopedSlots:e._u([{key:"actions",fn:function(){return[t("NcButton",{attrs:{disabled:e.hasLoading,type:"submit",variant:"primary"},on:{click:function(t){return e.send()}},scopedSlots:e._u([{key:"icon",fn:function(){return[e.hasLoading?t("NcLoadingIcon",{attrs:{size:20}}):e._e()]},proxy:!0}],null,!1,3338175147)},[e._v("\n\t\t\t"+e._s(e.t("libresign","Confirm"))+"\n\t\t")])]},proxy:!0}],null,!1,2622024213)},[t("p",[e._v(e._s(e.t("libresign","For security reasons, you must create a password to sign the documents. Enter your new password in the field below.")))]),e._v(" "),t("NcPasswordField",{attrs:{disabled:e.hasLoading,label:e.t("libresign","Enter a password"),placeholder:e.t("libresign","Enter a password")},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):e._e()}),[],!1,null,null,null).exports},7334:e=>{function t(e,t=100,s={}){if("function"!=typeof e)throw new TypeError(`Expected the first parameter to be a function, got \`${typeof e}\`.`);if(t<0)throw new RangeError("`wait` must not be negative.");const{immediate:n}="boolean"==typeof s?{immediate:s}:s;let i,r,a,o,l;function d(){const t=i,s=r;return i=void 0,r=void 0,l=e.apply(t,s),l}function c(){const e=Date.now()-o;e<t&&e>=0?a=setTimeout(c,t-e):(a=void 0,n||(l=d()))}const u=function(...e){if(i&&this!==i&&Object.getPrototypeOf(this)===Object.getPrototypeOf(i))throw new Error("Debounced method called with different contexts of the same prototype.");i=this,r=e,o=Date.now();const s=n&&!a;return a||(a=setTimeout(c,t)),s&&(l=d()),l};return Object.defineProperty(u,"isPending",{get:()=>void 0!==a}),u.clear=()=>{a&&(clearTimeout(a),a=void 0)},u.flush=()=>{a&&u.trigger()},u.trigger=()=>{l=d(),u.clear()},u}e.exports.debounce=t,e.exports=t},9646:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var n=s(1354),i=s.n(n),r=s(6314),a=s.n(r)()(i());a.push([e.id,"/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n/**\n * SPDX-FileCopyrightText: 2021 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n/*\n* Ensure proper alignment of the vue material icons\n*/\n.material-design-icon[data-v-09fb8faa] {\n  display: flex;\n  align-self: center;\n  justify-self: center;\n  align-items: center;\n  justify-content: center;\n}\n[data-v-09fb8faa] .password-field__input--secure-text {\n  -webkit-text-security: disc;\n}","",{version:3,sources:["webpack://./node_modules/@nextcloud/vue/dist/assets/NcPasswordField-whtKJFcB.css"],names:[],mappings:"AAAA;;;EAGE;AACF;;;EAGE;AACF;;CAEC;AACD;EACE,aAAa;EACb,kBAAkB;EAClB,oBAAoB;EACpB,mBAAmB;EACnB,uBAAuB;AACzB;AACA;EACE,2BAA2B;AAC7B",sourcesContent:["/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n/**\n * SPDX-FileCopyrightText: 2021 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n/*\n* Ensure proper alignment of the vue material icons\n*/\n.material-design-icon[data-v-09fb8faa] {\n  display: flex;\n  align-self: center;\n  justify-self: center;\n  align-items: center;\n  justify-content: center;\n}\n[data-v-09fb8faa] .password-field__input--secure-text {\n  -webkit-text-security: disc;\n}"],sourceRoot:""}]);const o=a}}]);
//# sourceMappingURL=libresign-src_views_CreatePassword_vue.js.map?v=c08635fd346ebe2dd133